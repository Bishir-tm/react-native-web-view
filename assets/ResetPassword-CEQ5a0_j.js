import{r as t,e as N,j as s}from"./index-DQeOCy18.js";import{E as P}from"./ErrorText-C3VDSOUb.js";import{I as c}from"./InputText-DHxi1m5K.js";import{F as m,a as w}from"./EyeIcon-CIkAS62p.js";function v(){const[o,u]=t.useState(""),[n,x]=t.useState(""),[p,a]=t.useState(!1),[h,r]=t.useState(""),[l,f]=t.useState(!1),[i,b]=t.useState(!1),y=N(),g=async()=>{try{if(a(!0),r(""),o!==n){r("Passwords do not match."),a(!1);return}const e=new URLSearchParams(window.location.search).get("token");if(!e){r("Invalid or missing token."),a(!1);return}const d=await fetch("/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e,newPassword:o})}),j=await d.json();a(!1),d.ok?(alert("Password reset successful. You can now log in."),y("/login")):r(j.message||"Error resetting password.")}catch{a(!1),r("An error occurred. Please try again.")}};return s.jsx("div",{className:"min-h-screen bg-base-200 flex items-center",children:s.jsx("div",{className:"card mx-auto w-full max-w-md shadow-xl bg-base-100 rounded-xl",children:s.jsxs("div",{className:"py-12 px-10",children:[s.jsx("h2",{className:"text-2xl font-semibold mb-4 text-center",children:"Reset Password"}),s.jsx("p",{className:"mb-8 text-center font-semibold",children:"Enter your new password below."}),s.jsxs("form",{onSubmit:e=>{e.preventDefault(),g()},children:[s.jsxs("div",{className:"mb-4 relative",children:[s.jsx(c,{type:l?"text":"password",value:o,updateType:"password",containerStyle:"mt-4",labelTitle:"New Password",placeholder:"Enter your new password",updateFormValue:({value:e})=>u(e)}),s.jsx("button",{type:"button",className:"absolute right-3 top-10",onClick:()=>f(e=>!e),children:l?s.jsx(m,{className:"h-5 w-5 text-gray-500"}):s.jsx(w,{className:"h-5 w-5 text-gray-500"})})]}),s.jsxs("div",{className:"mb-4 relative",children:[s.jsx(c,{type:i?"text":"password",value:n,updateType:"confirmPassword",containerStyle:"mt-4",labelTitle:"Confirm Password",placeholder:"Confirm your new password",updateFormValue:({value:e})=>x(e)}),s.jsx("button",{type:"button",className:"absolute right-3 top-10",onClick:()=>b(e=>!e),children:i?s.jsx(m,{className:"h-5 w-5 text-gray-500"}):s.jsx(w,{className:"h-5 w-5 text-gray-500"})})]}),s.jsx(P,{styleClass:"mt-4",children:h}),s.jsx("button",{type:"submit",className:"btn mt-4 w-full btn-primary"+(p?" loading":""),children:"Reset Password"})]})]})})})}function T(){return s.jsx("div",{className:"",children:s.jsx(v,{})})}export{T as default};
